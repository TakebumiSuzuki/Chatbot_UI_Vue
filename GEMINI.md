
# RAGチャットアプリケーション フロントエンド仕様

## 1. 概要
ChatGPTやGeminiのようなUIを持つRAG（Retrieval-Augmented Generation）チャットアプリケーションのフロントエンドを開発する。バックエンドは現時点では開発しない。

## 2. UI/UX要件
- **全体レイアウト:**
  - 画面を左右2つのペインに分割する。
  - 左ペイン: `SidePanel.vue` (情報ソース表示領域)
  - 右ペイン: `ChatView.vue` (チャット会話領域)
  - 2つのペインの境界はドラッグでリサイズ可能にする。

- **左ペイン (`SidePanel.vue`):**
  - 初期幅: 800px
  - 可変幅: 600px 〜 1000px
  - 現段階では中身は空とし、`sourceContext` という変数を定義するに留める。

- **右ペイン (`ChatView.vue`):**
  - **チャット履歴:**
    - 会話履歴を時系列で表示し、長くなると自動的にスクロールバーが表示される。
    - AIからの返答は左寄せ、ユーザーの入力は右寄せで表示する。
    - 開発段階ではダミーのJSONファイルから履歴を読み込む。将来的にはFlask APIとの通信で取得・更新する。
  - **入力フォーム (`ChatInput.vue`):**
    - 画面最下部に配置。
    - 最大200文字の入力制限を設け、`現在の文字数/最大文字数` (例: `0/200`) のカウンターを表示する。
    - 送信ボタンには紙飛行機のアイコンを使用する。

- **インタラクション:**
  - 送信ボタンをクリックすると `sendMessage` 関数が呼び出される。
  - データ送信中:
    - チャット履歴の下部にローダー（Lucide Iconのスピナー）を表示する。
    - 入力フィールドと送信ボタンを無効化し、透明度を60%にする。
  - レスポンス受信後、入力フィールドと送信ボタンを再度有効化する。
  - AIの返答はタイプライター風のアニメーションで表示する。

- **エラーハンドリング:**
  - API通信失敗時などには、「Failed to send message.」のようなエラーメッセージをチャット内に表示する。

## 3. 機能要件
- **`sendMessage` 関数:**
  - 将来的に、ユーザー入力をWebSocket経由でバックエンドのFlask APIサーバーに送信する。

- **ダミーデータ:**
  - 開発用のチャット履歴を `public/dummy-chat-history.json` として用意する。
  - データ構造は以下の通りとする。
    ```json
    [
      { "id": 1, "role": "user", "content": "Hello, who are you?" },
      { "id": 2, "role": "ai", "content": "I am a helpful assistant." },
      { "id": 3, "role": "error", "content": "Failed to send message." }
    ]
    ```

## 4. 技術スタック
- **基本方針:** すべてのライブラリ、依存関係において、可能な限り最新の安定バージョンを使用する。
- **フレームワーク:** Vue 3 (JavaScript)
- **ビルドツール:** Vite
- **CSSフレームワーク:** Tailwind CSS v4
- **リンター:** ESLint
- **アイコン:** Lucide Icons
  - `vite-svg-loader` を使用し、SVGファイルをVueコンポーネントとしてインポートする。
  - ユーザーとAIのアバターは、最終的にSVGコードで生成する。それまでは一時的なプレースホルダー（色付きの円など）を使用する。
- **リサイズ機能:** `split.js` ライブラリを使用する。
- **WebSocket:** `socket.io-client` ライブラリを使用する（バックエンドはFlask + python-socketioを想定）。

## 5. デザイン・スタイル
- **言語:** ユーザーに表示されるすべてのUIテキスト、ログは英語で記述する。
- **テーマ:** 全体的にダークモード（黒基調）
- **アクセントカラー:** ボタンなどには青または紫のグラデーションを適用する。
- **フォント:** Google Fonts の "Noto Sans" を使用する。CSS内でCDNから直接`@import`する。

---

# 実行計画

以下に示すステップを一つずつ実行し、都度あなたの確認を得ながら開発を進めます。

- **ステップ1: プロジェクトの初期化**
  - `frontend` ディレクトリを作成し、Viteを使ってVue 3 (JavaScript) プロジェクトをセットアップする。

- **ステップ2: 本番用依存関係のインストール**
  - `frontend` ディレクトリに移動し、`socket.io-client` と `split.js` をインストールする。

- **ステップ3: 開発用依存関係のインストール**
  - `tailwindcss`, `postcss`, `autoprefixer`, `vite-svg-loader`, `eslint`, `eslint-plugin-vue` をインストールする。

- **ステップ4: 各種設定ファイルの構成**
  - メインのCSSファイル (`src/style.css`) を作成し、`@import "tailwindcss";` とGoogle Fontsの`@import`文を記述する。
  - `.eslintrc.cjs` を作成し、Vue用のルールを設定する。
  - `vite.config.js` に `vite-svg-loader` の設定を追記する。

- **ステップ5: プロジェクトの基本構造とダミーデータの作成**
  - `src/components`, `src/assets/icons` などのディレクトリを作成する。
  - `public/dummy-chat-history.json` を作成する。
  - 必要なLucideアイコン (`Loader2`, `User`, `Bot`, `Send`など) をSVGファイルとしてダウンロードし、`src/assets/icons` に配置する。

- **ステップ6: Vueコンポーネントのスケルトン作成**
  - `App.vue` および `src/components` 内に、各コンポーネントの空ファイルを作成する。
  - `main.js` でメインCSSファイルをインポートする。

- **ステップ7: メインレイアウトの実装 (`App.vue`)**
  - `SidePanel.vue` と `ChatView.vue` をインポートし、2ペインのレイアウトを構成する。
  - `split.js` を初期化し、リサイズ機能を有効にする。

- **ステップ8: サイドパネルの実装 (`SidePanel.vue`)**
  - `sourceContext` 変数を定義し、基本的なパネルのUIを構築する。

- **ステップ9: チャットビューの実装 (`ChatView.vue`)**
  - ダミーJSONからチャット履歴を非同期で読み込み、表示する。
  - `ChatMessage.vue` と `ChatInput.vue` をインポートして配置する。

- **ステップ10: チャットメッセージの実装 (`ChatMessage.vue`)**
  - `role` (`user`, `ai`, `error`) に応じてスタイルを動的に変更する。
  - アイコンのプレースホルダーを表示する。

- **ステップ11: チャット入力欄の実装 (`ChatInput.vue`)**
  - 文字数カウンター付きの入力フィールドと送信ボタンを作成する。
  - `sendMessage` イベントを発行するロジックを実装する。

- **ステップ12: 中核となるチャットロジックの実装**
  - `ChatView.vue` に `sendMessage` 関数を実装する。
  - メッセージ追加、ローダー表示、入力欄の無効化/有効化を制御する。
  - タイプライターエフェクトを実装する。

- **ステップ13: 全体のスタイリングと仕上げ**
  - ダークテーマ、グラデーション、フォントなど、最終的なデザインを全体に適用する。

- **ステップ14: アイコンの生成**
  - プレースホルダーを、SVGコードで生成したカスタムアイコンに置き換える。
